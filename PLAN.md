# Development Plan (Step-wise)

> **期間** : 2025-06-21 〜 2025-07-03  
> **ブランチ戦略** : `main` (保護) + `feat/*` PR  
> **開発方針** : 段階的実装（各フェーズで動作確認可能な状態を維持）

## Phase Summary

| Phase | タスクブロック                  | 実装内容                              | 成果物             | 状態     |
| ----- | ------------------------------- | ------------------------------------- | ------------------ | -------- |
| **1** | **プロジェクト基盤構築**        | Next.js セットアップ、開発環境整備    | 初回 CI パス       | ✅完了   |
| **2** | **GitHub API & データレイヤ**   | API クライアント実装、型定義          | API ユーティリティ | ✅完了   |
| **3** | **検索ページ (無限スクロール)** | デバウンス検索、無限スクロール実装    | 検索機能完成       | ✅完了   |
| **4** | **詳細ページ**                  | Server Component による詳細表示       | 詳細ページ完成     | ✅完了   |
| **5** | **テスト & CI 拡充**            | ユニット/コンポーネントテスト、CI強化 | テスト完備         | ✅完了   |
| **6** | **ドキュメント & リファクタ**   | README整備、TypeScript厳格化、UI改善  | 本番レディ         | ✅完了   |
| **7** | **レビュー → 完了**             | 最終確認とリリース準備                | v0.1.0 リリース    | 🔲未着手 |

## Detailed Implementation Steps

### Phase 1: プロジェクト基盤構築

| タスク               | 実装詳細                                                                | 完了条件             |
| -------------------- | ----------------------------------------------------------------------- | -------------------- |
| Next.js セットアップ | `create-next-app@latest` で TypeScript、Tailwind CSS、App Router を選択 | 開発サーバー起動確認 |
| 依存関係インストール | TanStack Query、react-hot-toast、lucide-react                           | package.json 更新    |
| ESLint/Prettier 設定 | Next.js デフォルト設定 + Prettier 統合                                  | フォーマット動作確認 |
| GitHub Actions 設定  | Node.js LTS、npm cache、テスト実行                                      | 初回ビルド成功       |
| shadcn/ui 導入       | components.json 設定、必要コンポーネント追加                            | UIコンポーネント動作 |

### Phase 2: GitHub API & データレイヤ

| タスク                         | 実装詳細                                           | 完了条件               |
| ------------------------------ | -------------------------------------------------- | ---------------------- |
| 環境変数設定                   | `.env.local` で `GH_PAT` 管理、`.env.example` 作成 | 環境変数読み込み確認   |
| 型定義 (`types.ts`)            | `Repository` 型を定義（必要最小限のフィールド）    | TypeScript エラーなし  |
| API クライアント (`github.ts`) | `searchRepositories`、`getRepositoryDetails` 実装  | 単体テスト成功         |
| エラーハンドリング             | 429/403/404 エラーの適切な処理                     | エラーケーステスト成功 |
| ユニットテスト                 | Jest でモック API テスト                           | カバレッジ 100%        |

### Phase 3: 検索ページ (無限スクロール)

| タスク                   | 実装詳細                                    | 完了条件                 |
| ------------------------ | ------------------------------------------- | ------------------------ |
| SearchBar コンポーネント | デバウンス (300ms)、URL クエリ同期          | 入力→URL更新確認         |
| RepoList コンポーネント  | `useInfiniteQuery` による無限スクロール     | スクロールで追加読み込み |
| RepoCard コンポーネント  | リポジトリ情報表示、ホバーエフェクト        | デザイン確認             |
| API Routes 実装          | `/api/github/search` でページネーション対応 | API レスポンス確認       |
| 状態管理                 | ローディング、エラー、空状態の表示          | 各状態の UI 確認         |

### Phase 4: 詳細ページ

| タスク           | 実装詳細                                         | 完了条件             |
| ---------------- | ------------------------------------------------ | -------------------- |
| 動的ルーティング | `/repo/[owner]/[name]` の実装（Next.js 15 対応） | ルーティング動作確認 |
| RepoDetailCard   | Star/Fork/Issue/Watcher 数の表示                 | 統計情報表示確認     |
| Server Component | `getRepositoryDetails` を直接呼び出し            | SSR 動作確認         |
| API Route        | `/api/github/repo` 実装                          | API レスポンス確認   |
| ナビゲーション   | 戻るリンク、ページ遷移                           | 画面遷移確認         |

### Phase 5: テスト & CI 拡充

| タスク                | 実装詳細                             | 完了条件     |
| --------------------- | ------------------------------------ | ------------ |
| SearchBar テスト      | デバウンス動作、URL同期のテスト      | テスト成功   |
| RepoList テスト       | 無限スクロール、状態表示のテスト     | テスト成功   |
| RepoDetailCard テスト | props 表示、数値フォーマットのテスト | テスト成功   |
| CI ワークフロー更新   | Lint (--max-warnings 0)、テスト実行  | CI 成功      |
| 手動 E2E テスト       | MCP Playwright による動作確認        | シナリオ完了 |

### Phase 6: ドキュメント & リファクタ

| タスク             | 実装詳細                                 | 完了条件               |
| ------------------ | ---------------------------------------- | ---------------------- |
| README 拡充        | セットアップ、アーキテクチャ、AI活用方法 | 他者が理解可能         |
| TypeScript 厳格化  | `exactOptionalPropertyTypes` 有効化      | ビルド成功             |
| UI 改善            | 詳細ページの文字色調整（視認性向上）     | デザイン確認           |
| パフォーマンス調整 | QueryClient の staleTime 設定 (60秒)     | キャッシュ動作確認     |
| 不要コード削除     | 未使用コンポーネントの削除               | クリーンなコードベース |

### Phase 7: レビュー → 完了

| タスク             | 実装詳細                         | 完了条件         |
| ------------------ | -------------------------------- | ---------------- |
| 最終動作確認       | 全機能の手動テスト               | すべて正常動作   |
| コードレビュー     | 型安全性、命名規則、コメント確認 | レビュー指摘対応 |
| セキュリティ確認   | 環境変数、認証情報の扱い         | 脆弱性なし       |
| パフォーマンス確認 | Lighthouse スコア確認            | 良好なスコア     |
| リリース準備       | タグ付け、リリースノート作成     | v0.1.0 公開      |

## 技術的決定事項

### 採用技術の選定理由

| 技術                | 選定理由                                                     | 代替案を選ばなかった理由        |
| ------------------- | ------------------------------------------------------------ | ------------------------------- |
| Next.js App Router  | - SSR/CSR の柔軟な組み合わせ<br>- ファイルベースルーティング | Pages Router は旧世代           |
| TanStack Query      | - 無限スクロール対応<br>- キャッシュ管理が優秀               | SWR は無限スクロール実装が複雑  |
| Tailwind CSS        | - 開発速度<br>- ダークテーマ対応                             | CSS Modules は記述量が多い      |
| TypeScript (strict) | - 型安全性<br>- リファクタリング耐性                         | JavaScript は大規模化で保守困難 |

### 設計方針

| 項目               | 方針                       | 理由                         |
| ------------------ | -------------------------- | ---------------------------- |
| コンポーネント設計 | 単一責任の原則             | テスタビリティと再利用性     |
| 状態管理           | URL をソースオブトゥルース | ブラウザバック対応、共有可能 |
| エラー処理         | 早期リターン               | コードの可読性向上           |
| テスト戦略         | 重要な機能に集中           | 開発速度とのバランス         |

## リスク管理

| リスク                  | 影響度 | 発生確率 | 対策                                                       | 実施状況 |
| ----------------------- | ------ | -------- | ---------------------------------------------------------- | -------- |
| GitHub API レート制限   | 高     | 中       | - PAT 使用で 5000req/h 確保<br>- エラーメッセージ表示      | ✅対策済 |
| 無限スクロール不具合    | 中     | 低       | - react-intersection-observer 採用<br>- フォールバック実装 | ✅対策済 |
| TypeScript 厳格化の影響 | 低     | 中       | - 段階的に有効化<br>- 型エラーは都度修正                   | ✅対策済 |
| パフォーマンス劣化      | 中     | 低       | - キャッシュ戦略<br>- デバウンス実装                       | ✅対策済 |

## 学習ポイント

### 技術的な学び

1. **Next.js 15 の変更点**: Dynamic Segments の params が Promise に
2. **無限スクロール実装**: useInfiniteQuery + IntersectionObserver の組み合わせ
3. **デバウンス実装**: カスタムフックによる再利用可能な実装
4. **TypeScript 厳格化**: exactOptionalPropertyTypes による null 安全性

### プロジェクト管理の学び

1. **段階的実装**: 各フェーズで動作確認可能な状態を維持
2. **ドキュメント駆動開発**: 設計書を先に作成し、実装と同期
3. **AI 活用**: コンテキスト共有による効率的な開発

## メトリクス

### コード品質

- TypeScript カバレッジ: 100%
- Lint エラー: 0件
- テストカバレッジ: 主要機能をカバー

### パフォーマンス

- 初期表示: < 1秒
- 検索レスポンス: < 500ms（キャッシュヒット時）
- バンドルサイズ: 約120KB (First Load JS)

### 開発効率

- 実装期間: 13日間
- コミット数: 約20件（フェーズごと）
- AI 利用率: 約80%（コード生成・レビュー）
